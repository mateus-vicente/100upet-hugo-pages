<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.100.2" />
<link rel="canonical" type="text/html" href="https://100upet-specifications.docs.cern.ch/docs/">
<link rel="alternate" type="application/rss&#43;xml" href="https://100upet-specifications.docs.cern.ch/docs/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Internal | Home</title>
<meta name="description" content="">
<meta property="og:title" content="Internal" />
<meta property="og:description" content="100µPET in english" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://100upet-specifications.docs.cern.ch/docs/" /><meta property="og:site_name" content="Home" />

<meta itemprop="name" content="Internal">
<meta itemprop="description" content="100µPET in english"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Internal"/>
<meta name="twitter:description" content="100µPET in english"/>




<link rel="preload" href="/scss/main.min.8adc2ec9ee55657775e041971573dece4396294f97b8a3d2e68cb4a7be60ba2f.css" as="style">
<link href="/scss/main.min.8adc2ec9ee55657775e041971573dece4396294f97b8a3d2e68cb4a7be60ba2f.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<script
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<link rel="stylesheet" href="/css/prism.css"/>

  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"></span><span class="font-weight-bold">Home</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/about/" ><span>Project</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/people/" ><span>People</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/publications/" ><span>Publications</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="/docs/" ><span class="active">Internal</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/app/" ><span>App</span></a>
			</li>
			
			
			
			<li class="nav-item dropdown mr-4 d-none d-lg-block">
				

<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
	English
</a>
<div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
	
	<a class="dropdown-item" href="/fr/">French</a>
	
</div>
			</li>
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"><input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.bd64771e70e01dfd4755cd43649ec912.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Internal</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-dfd5e54e0b0e9e1de8c8c1fb8a36bef6">Introduction</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>1.1: <a href="#pg-516450712d7dad634ee88ca28446a273">Scope of these pages</a></li>


    
  
    
    
	
<li>1.2: <a href="#pg-e7c98ec79fbb76d6306ede7df72c6f9a">Scanner description</a></li>


    
  
    
    
	
<li>1.3: <a href="#pg-404da5500b456090e3d37ffb21d13235">ASIC description</a></li>


    
  
    
    
	
<li>1.4: <a href="#pg-d1ae8cafec0da551015ebccb71eee2f2">Scanner simulation</a></li>


    
  
    
    
	
<li>1.5: <a href="#pg-cccfdb85501f2f1888b8f5ac231faf2a">Imaging reconstruction</a></li>


    
  

    </ul>
    
  
    
    
	
<li>2: <a href="#pg-ee465eac0721f6fe2d7b67521445df93">ASIC R&amp;D</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>2.1: <a href="#pg-b69dd4591a73fb14d83cf340701fc44d">ASIC specifications</a></li>


    
  
    
    
	
<li>2.2: <a href="#pg-ffac7a43af84b11b416044970ce07d29">ASIC discussion</a></li>


    
  

    </ul>
    
  
    
    
	
<li>3: <a href="#pg-b85ba2bee7637e8ea54c94087031bedb">Detector assembly</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>3.1: <a href="#pg-85839dd02742b21a3d4289ab284f7fe8">Configuration Files</a></li>


    
  

    </ul>
    
  
    
    
	
<li>4: <a href="#pg-fe9ad015fbb973998788a14010d61608">Scanner simulation</a></li>


    
    <ul>
        
  
  
  
  

  
    
    
	
<li>4.1: <a href="#pg-e4564ad7ae168d8f31bc049adc19a762">Configuration Files</a></li>


    
  

    </ul>
    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-dfd5e54e0b0e9e1de8c8c1fb8a36bef6">1 - Introduction</h1>
    <div class="lead">Introduction to the 100µPET project.</div>
	<p>The 100μPET project aims at the construction of a novel generation small-animal Positron Emission Tomography (PET) scanner, with unprecedented volumetric spatial resolution to perform ultra-high resolution molecular imaging of the onset and progression of atherosclerosis in ApoE-/- mice.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-516450712d7dad634ee88ca28446a273">1.1 - Scope of these pages</h1>
    
	<p>This document is meant to be the primary point of information for the development of the project.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e7c98ec79fbb76d6306ede7df72c6f9a">1.2 - Scanner description</h1>
    
	<p>This page describes the scanner.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-404da5500b456090e3d37ffb21d13235">1.3 - ASIC description</h1>
    
	<p>This page describes final specifications of the scanner&rsquo;s pixel ASIC.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d1ae8cafec0da551015ebccb71eee2f2">1.4 - Scanner simulation</h1>
    
	<p>This page describes the scanner simulation.</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-cccfdb85501f2f1888b8f5ac231faf2a">1.5 - Imaging reconstruction</h1>
    
	<p>This page describes the imaging reconstruction.</p>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ee465eac0721f6fe2d7b67521445df93">2 - ASIC R&amp;D</h1>
    <div class="lead">100µPET ASIC details.</div>
	<p>This section aims to list the specifications of the 100µPET scanner.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-b69dd4591a73fb14d83cf340701fc44d">2.1 - ASIC specifications</h1>
    
	<h2 id="asic-details">ASIC details</h2>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-ffac7a43af84b11b416044970ce07d29">2.2 - ASIC discussion</h1>
    
	<p>From 07.10.2022</p>
<h3 id="differences-with-faser">Differences with FASER</h3>
<ol>
<li>Dead Area is not an issue</li>
<li>Keep same analog</li>
<li>No need of keeping charge information in the matrix</li>
<li>Small Cluster (7 pixel rare but possible )</li>
<li>Possible charge info: <strong>10 keV to 500 keV</strong> per cluster
<ol>
<li>Peak Charge?</li>
<li>Full cluster charge?</li>
</ol>
</li>
<li>Charge Threshold <strong>3000e-</strong></li>
<li>Power Density <strong>80 mW/cmˆ2</strong></li>
<li>HitRate <strong>5kHz/chip</strong> ==&gt; 200us to readout. We don&rsquo;t have idle</li>
</ol>
<p><strong>FASER power consumption</strong></p>
<ul>
<li>2uA per pixel FE</li>
<li>5uA per pixel Discriminator</li>
</ul>
<h3 id="open-questions">Open questions</h3>
<ul>
<li>Do we need pixel calibration?</li>
<li>256 x208 pixels: 53k pixels. How long it takes to calibrate?</li>
<li>Mismatch: where does it come from? Can we improve it?</li>
</ul>
<h3 id="to-be-answered-by-monte-carlo-simulations">To be answered by Monte Carlo simulations:</h3>
<ul>
<li>Possible charge info: 10 keV  to 500 keV per cluster
<ul>
<li>Peak Charge?</li>
<li>Full cluster charge?</li>
<li>No Charge?</li>
</ul>
</li>
</ul>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Note</h4>

    ⚠️ <strong>Prepare minimum specifications of two versions : Charge readout / no charge readout .
For 20th October
Decision to take between the two by 27 October??</strong>

</div>

<h2 id="task-list">Task list</h2>
<ul>
<li><input disabled="" type="checkbox"> Charge Threshold calibration. Target 3000 e threshold, evaluate mismatch and calculate time for calibration
<ul>
<li>CMOS or BJT?</li>
<li>Auto zeros
<ul>
<li><strong>Priority 1 Thanu. Dead line TBD, long task</strong></li>
</ul>
</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Total variation data transmission time top to bottom for Faser (Measurement). Plus simulation (Monolith)
<ul>
<li><strong>Priority 1 Lorenzo and Antonio Deadline 20 October</strong></li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Measure power of ACF
<ul>
<li><strong>Priority 1 Luca/Mateus Dead Line ASAP</strong></li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Evaluate Calibration time
<ul>
<li><strong>Priority 1 Roberto Dead Line 20 October</strong></li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Matrix placement distribution (Lorenzo)
<ul>
<li><strong>Priority 2 Lorenzo Dead line TBD</strong></li>
</ul>
</li>
<li><input disabled="" type="checkbox"> I/Os: Faser case TASK : evaluate the PET case and evaluate
<ul>
<li>3 chip ID</li>
<li>6 Trigger Fast for debugging (Test Only)</li>
<li>2 trigger slow (Test only)</li>
<li>2 Readout clock</li>
<li>4 Data out</li>
<li>1 THR</li>
<li>2 test pulse</li>
<li>3 SPI</li>
<li>1 HV needs more spacing</li>
<li>2 Reset
<ul>
<li>Introduce a read from SPI
<ul>
<li><strong>Priority 2  Roberto / Lorenzo</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Power Domain evaluation: DRAW A POWER SCHEMA
<ul>
<li>BJT analog / digital / threshold</li>
<li>CMOS analog /digital
<ul>
<li><strong>Priority 2 Antonio Deadline TBD</strong></li>
</ul>
</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> 125um +125 um pitch : Evaluate voltage drop and PADS multiplicity
<ul>
<li>11ohm  resistance super column. 20mA of digital</li>
<li>Target is to have a pad at least one pad of 20mA
<ul>
<li><strong>Priority 2 Lorenzo / Roberto  Deadline TBD</strong></li>
</ul>
</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Evaluate Chip to Chip communication
<ul>
<li><strong>Priority 3 not assigned</strong></li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Introduce GITlab task system:
<ul>
<li><strong>Background task Thanu</strong></li>
</ul>
</li>
</ul>

</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b85ba2bee7637e8ea54c94087031bedb">3 - Detector assembly</h1>
    <div class="lead">Plans for ASIC integration into flex and tower assembly</div>
	<p>Starting from the scanner&rsquo;s front-end detector towards the back-end system, the scanner assembly starts with the integration of 4 detectors ASICs, in a 2x2 arrangement with 300 µm gap, into a Flexible-Printed-Circuit (FPC). Each ASIC will have an Au stud bump on each bonding pad, placed using a wire-bonding machine. Each ASIC will be connected to the flex by flip-chip using Araldite 2011, meaning that the FPC bonding pads have the same layout as in the ASIC. Each FPC will host small 0201 SMD components in small regions close to the top and bottom peripheries of the 2x2 chip arrangement. The data lines and low-voltage power for the ASIC are routed via the a wide flex tail (to be connected to a rigid board hosting a ZIF connector), while the high-voltage for sensor biasing is routed via a thin flex tail with a dedicated HV connector (200 V, &lt;1 mA). The width of the flex is from 100 to 200 µm smaller than the width of the 2x2 chip arrangement, at least in the region of where the chips are placed to allow an external cooling block to mechanicaly be in contact with the lateral edges of the chips for cooling optimization.
This section is meant to document the plans for the ASIC integration into the scanner.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-85839dd02742b21a3d4289ab284f7fe8">3.1 - Configuration Files</h1>
    
	<p>The framework is configured with simple human-readable configuration files. The configuration format is described in detail
in <a href="../../04_framework/03_configuration#file-format">Section 4.3</a>. It consists of several section headers within <code>[</code> and <code>]</code>
brackets, and a section without header at the start. Each of these sections contains a set of key/value pairs separated by
the <code>=</code> character. Comments are indicated using the hash symbol (<code>#</code>).</p>
<p>The framework has the following three required layers of configuration files:</p>
<ul>
<li>
<p>The <strong>main</strong> configuration:
The most important configuration file and the file that is passed directly to the binary. Contains both the global
framework configuration and the list of modules to instantiate together with their configuration. An example can be found
in the repository at <code>examples/example.conf</code>. More details and a more thorough example are found in
<a href=".././02_main_configuration">Section 3.2</a>, several advanced simulation chain configurations are presented in
<a href="../../08_examples">Chapter 8</a>.</p>
</li>
<li>
<p>The <strong>geometry</strong> configuration:
It is passed to the framework to determine the detector setup and passive materials. Describes the detector setup,
containing the position, orientation and model type of all detectors. Optionally, passive materials can be added to this
configuration. Examples are available in the repository at <code>examples/ example_detector.conf</code> or
<code>examples/example_detector_passive.conf</code>. Introduced in <a href=".././03_detector_configuration">Section 3.3</a>.</p>
</li>
<li>
<p>The detector <strong>model</strong> configuration:
Contains the parameters describing a particular type of detector. Several models are already provided by the framework,
but new types of detectors can easily be added. See <code>models/test.conf</code> in the repository for an example. Please refer to
<a href="../../09_development/05_new_detector_model">Section 9.5</a> for more details about adding new models.</p>
</li>
</ul>
<h2 id="parsing-types-and-units">Parsing Types and Units</h2>
<p>The Allpix Squared framework supports the use of a variety of types for all configuration values. The module specifies how
the value type should be interpreted. An error will be raised if either the key is not specified in the configuration file,
the conversion to the desired type is not possible, or if the given value is outside the domain of possible options. Please
refer to the <a href="../../07_modules">Chapter 7</a> for the list of module parameters and their types. Parsing the value
roughly follows common-sense (more details can be found in
<a href="../../04_framework/03_configuration#accessing-parameters">Section 4.3</a>). A few special rules do apply:</p>
<ul>
<li>
<p>If the value is a <strong>string</strong>, it may be enclosed by a single pair of double quotation marks (<code>&quot;</code>), which are stripped
before passing the value to the modules. If the string is not enclosed by quotation marks, all whitespace before and
after the value is erased. If the value is an array of strings, the value is split at every whitespace or comma (<code>,</code>)
that is not enclosed in quotation marks.</p>
</li>
<li>
<p>If the value is a <strong>boolean</strong>, either numerical (<code>0</code>, <code>1</code>) or textual (<code>false</code>, <code>true</code>) representations are accepted.</p>
</li>
<li>
<p>If the value is a <strong>relative path</strong>, that path will be made absolute by adding the absolute path of the directory that
contains the configuration file where the key is defined.</p>
</li>
<li>
<p>If the value is an <strong>arithmetic</strong> type, it may have a suffix indicating the unit. The list of base units is given in the
table below.</p>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">Quantity</th>
<th style="text-align:left">Default unit</th>
<th style="text-align:left">Auxiliary units</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Unity</td>
<td style="text-align:left">1</td>
<td style="text-align:left">-</td>
</tr>
<tr>
<td style="text-align:left">Length</td>
<td style="text-align:left">mm (millimeter)</td>
<td style="text-align:left">nm (nanometer), <br> um (micrometer), <br> cm (centimeter), <br> dm (decimeter), <br> m (meter), <br> km (kilometer)</td>
</tr>
<tr>
<td style="text-align:left">Time</td>
<td style="text-align:left">ns (nanosecond)</td>
<td style="text-align:left">ps (picosecond), <br> us (microsecond), <br> ms (millisecond), <br> s (second)</td>
</tr>
<tr>
<td style="text-align:left">Energy</td>
<td style="text-align:left">MeV (megaelectronvolt)</td>
<td style="text-align:left">eV (electronvolt), <br> keV (kiloelectronvolt), <br> GeV (gigaelectronvolt)</td>
</tr>
<tr>
<td style="text-align:left">Temperature</td>
<td style="text-align:left">K (kelvin)</td>
<td style="text-align:left">-</td>
</tr>
<tr>
<td style="text-align:left">Charge</td>
<td style="text-align:left">e (elementary charge)</td>
<td style="text-align:left">ke (kiloelectrons), <br> fC (femtocoulomb), <br> C (coulomb)</td>
</tr>
<tr>
<td style="text-align:left">Voltage</td>
<td style="text-align:left">MV (megavolt)</td>
<td style="text-align:left">V (volt), <br> kV (kilovolt)</td>
</tr>
<tr>
<td style="text-align:left">Magnetic field strength</td>
<td style="text-align:left">T (tesla)</td>
<td style="text-align:left">mT (millitesla)</td>
</tr>
<tr>
<td style="text-align:left">Angle</td>
<td style="text-align:left">rad (radian)</td>
<td style="text-align:left">deg (degree), <br> mrad (milliradian)</td>
</tr>
<tr>
<td style="text-align:left">Radiation fluence</td>
<td style="text-align:left">Neq (1-MeV neutron-equivalent)</td>
<td style="text-align:left">-</td>
</tr>
</tbody>
</table>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    If no units are specified, values will always be interpreted in the base units of the framework. In some cases this can lead
to unexpected results. E.g. specifying a bias voltage as <code>bias_voltage = 50</code> results in an applied voltage of 50 MV.
Therefore it is strongly recommended to always specify units in the configuration files.

</div>

<p>The internal base units of the framework are not chosen for user convenience but for maximum precision of the calculations
and in order to avoid the necessity of conversions in the code.</p>
<p>Combinations of base units can be specified by using the multiplication sign <code>*</code> and the division sign <code>/</code> that are parsed in
linear order (thus $<code>\frac{V m}{s^2}</code>$ should be specified as <code>V*m/s/s</code>). The framework assumes the default units if the unit
is not explicitly specified. It is recommended to always specify the unit explicitly for all parameters that are not
dimensionless as well as for angles.</p>
<p>Examples of specifying key/values pairs of various types are given below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#75715e"># All whitespace at the front and back is removed</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">first_string</span> <span style="color:#f92672">=</span>   <span style="color:#e6db74">string_without_quotation</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># All whitespace within the quotation marks is preserved</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">second_string</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;  string with quotation marks  &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Keys are split on whitespace and commas</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">string_array</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;first element&#34; &#34;second element&#34;,&#34;third element&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Elements of matrices with more than one dimension are separated</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># using square brackets</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">string_matrix_3x3</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">[[&#34;1&#34;,&#34;0&#34;,&#34;0&#34;], [&#34;0&#34;,&#34;cos&#34;,&#34;-sin&#34;], [&#34;0&#34;,&#34;sin&#34;,cos]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If the matrix is of dimension 1xN, the outer brackets have to be</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># added explicitly</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">integer_matrix_1x3</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">[[10, 11, 12]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Integer and floats can be specified in standard formats</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">int_value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">42</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">float_value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">123.456e9</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Units can be passed to arithmetic types</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">energy_value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">1.23MeV</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">time_value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">42ns</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Units are combined in linear order without grouping or implicit brackets</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">acceleration_value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">1.0m/s/s</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Thus the quantity below is the same as 1.0deg*kV*K/m/s</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">random_quantity</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">1.0deg*kV/m/s*K</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Relative paths are expanded to absolute paths, e.g. the following value</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># will become &#34;/home/user/test&#34; if the configuration file is located</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># at &#34;/home/user&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">output_path</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;test&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Booleans can be represented in numerical or textual style</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">my_switch</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">true</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">my_other_switch</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">0</span>
</span></span></code></pre></div>
</div>



    
	
  

    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-fe9ad015fbb973998788a14010d61608">4 - Scanner simulation</h1>
    <div class="lead">Monte Carlo scanner simulation for performance evaluation.</div>
	<p>This section is meant to document and guide new users in the simulation of the scanner.</p>

</div>



    
      
  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-e4564ad7ae168d8f31bc049adc19a762">4.1 - Configuration Files</h1>
    
	<p>The framework is configured with simple human-readable configuration files. The configuration format is described in detail
in <a href="../../04_framework/03_configuration#file-format">Section 4.3</a>. It consists of several section headers within <code>[</code> and <code>]</code>
brackets, and a section without header at the start. Each of these sections contains a set of key/value pairs separated by
the <code>=</code> character. Comments are indicated using the hash symbol (<code>#</code>).</p>
<p>The framework has the following three required layers of configuration files:</p>
<ul>
<li>
<p>The <strong>main</strong> configuration:
The most important configuration file and the file that is passed directly to the binary. Contains both the global
framework configuration and the list of modules to instantiate together with their configuration. An example can be found
in the repository at <code>examples/example.conf</code>. More details and a more thorough example are found in
<a href=".././02_main_configuration">Section 3.2</a>, several advanced simulation chain configurations are presented in
<a href="../../08_examples">Chapter 8</a>.</p>
</li>
<li>
<p>The <strong>geometry</strong> configuration:
It is passed to the framework to determine the detector setup and passive materials. Describes the detector setup,
containing the position, orientation and model type of all detectors. Optionally, passive materials can be added to this
configuration. Examples are available in the repository at <code>examples/ example_detector.conf</code> or
<code>examples/example_detector_passive.conf</code>. Introduced in <a href=".././03_detector_configuration">Section 3.3</a>.</p>
</li>
<li>
<p>The detector <strong>model</strong> configuration:
Contains the parameters describing a particular type of detector. Several models are already provided by the framework,
but new types of detectors can easily be added. See <code>models/test.conf</code> in the repository for an example. Please refer to
<a href="../../09_development/05_new_detector_model">Section 9.5</a> for more details about adding new models.</p>
</li>
</ul>
<h2 id="parsing-types-and-units">Parsing Types and Units</h2>
<p>The Allpix Squared framework supports the use of a variety of types for all configuration values. The module specifies how
the value type should be interpreted. An error will be raised if either the key is not specified in the configuration file,
the conversion to the desired type is not possible, or if the given value is outside the domain of possible options. Please
refer to the <a href="../../07_modules">Chapter 7</a> for the list of module parameters and their types. Parsing the value
roughly follows common-sense (more details can be found in
<a href="../../04_framework/03_configuration#accessing-parameters">Section 4.3</a>). A few special rules do apply:</p>
<ul>
<li>
<p>If the value is a <strong>string</strong>, it may be enclosed by a single pair of double quotation marks (<code>&quot;</code>), which are stripped
before passing the value to the modules. If the string is not enclosed by quotation marks, all whitespace before and
after the value is erased. If the value is an array of strings, the value is split at every whitespace or comma (<code>,</code>)
that is not enclosed in quotation marks.</p>
</li>
<li>
<p>If the value is a <strong>boolean</strong>, either numerical (<code>0</code>, <code>1</code>) or textual (<code>false</code>, <code>true</code>) representations are accepted.</p>
</li>
<li>
<p>If the value is a <strong>relative path</strong>, that path will be made absolute by adding the absolute path of the directory that
contains the configuration file where the key is defined.</p>
</li>
<li>
<p>If the value is an <strong>arithmetic</strong> type, it may have a suffix indicating the unit. The list of base units is given in the
table below.</p>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">Quantity</th>
<th style="text-align:left">Default unit</th>
<th style="text-align:left">Auxiliary units</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">Unity</td>
<td style="text-align:left">1</td>
<td style="text-align:left">-</td>
</tr>
<tr>
<td style="text-align:left">Length</td>
<td style="text-align:left">mm (millimeter)</td>
<td style="text-align:left">nm (nanometer), <br> um (micrometer), <br> cm (centimeter), <br> dm (decimeter), <br> m (meter), <br> km (kilometer)</td>
</tr>
<tr>
<td style="text-align:left">Time</td>
<td style="text-align:left">ns (nanosecond)</td>
<td style="text-align:left">ps (picosecond), <br> us (microsecond), <br> ms (millisecond), <br> s (second)</td>
</tr>
<tr>
<td style="text-align:left">Energy</td>
<td style="text-align:left">MeV (megaelectronvolt)</td>
<td style="text-align:left">eV (electronvolt), <br> keV (kiloelectronvolt), <br> GeV (gigaelectronvolt)</td>
</tr>
<tr>
<td style="text-align:left">Temperature</td>
<td style="text-align:left">K (kelvin)</td>
<td style="text-align:left">-</td>
</tr>
<tr>
<td style="text-align:left">Charge</td>
<td style="text-align:left">e (elementary charge)</td>
<td style="text-align:left">ke (kiloelectrons), <br> fC (femtocoulomb), <br> C (coulomb)</td>
</tr>
<tr>
<td style="text-align:left">Voltage</td>
<td style="text-align:left">MV (megavolt)</td>
<td style="text-align:left">V (volt), <br> kV (kilovolt)</td>
</tr>
<tr>
<td style="text-align:left">Magnetic field strength</td>
<td style="text-align:left">T (tesla)</td>
<td style="text-align:left">mT (millitesla)</td>
</tr>
<tr>
<td style="text-align:left">Angle</td>
<td style="text-align:left">rad (radian)</td>
<td style="text-align:left">deg (degree), <br> mrad (milliradian)</td>
</tr>
<tr>
<td style="text-align:left">Radiation fluence</td>
<td style="text-align:left">Neq (1-MeV neutron-equivalent)</td>
<td style="text-align:left">-</td>
</tr>
</tbody>
</table>


<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">Warning</h4>

    If no units are specified, values will always be interpreted in the base units of the framework. In some cases this can lead
to unexpected results. E.g. specifying a bias voltage as <code>bias_voltage = 50</code> results in an applied voltage of 50 MV.
Therefore it is strongly recommended to always specify units in the configuration files.

</div>

<p>The internal base units of the framework are not chosen for user convenience but for maximum precision of the calculations
and in order to avoid the necessity of conversions in the code.</p>
<p>Combinations of base units can be specified by using the multiplication sign <code>*</code> and the division sign <code>/</code> that are parsed in
linear order (thus $<code>\frac{V m}{s^2}</code>$ should be specified as <code>V*m/s/s</code>). The framework assumes the default units if the unit
is not explicitly specified. It is recommended to always specify the unit explicitly for all parameters that are not
dimensionless as well as for angles.</p>
<p>Examples of specifying key/values pairs of various types are given below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#75715e"># All whitespace at the front and back is removed</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">first_string</span> <span style="color:#f92672">=</span>   <span style="color:#e6db74">string_without_quotation</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># All whitespace within the quotation marks is preserved</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">second_string</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;  string with quotation marks  &#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Keys are split on whitespace and commas</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">string_array</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;first element&#34; &#34;second element&#34;,&#34;third element&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Elements of matrices with more than one dimension are separated</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># using square brackets</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">string_matrix_3x3</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">[[&#34;1&#34;,&#34;0&#34;,&#34;0&#34;], [&#34;0&#34;,&#34;cos&#34;,&#34;-sin&#34;], [&#34;0&#34;,&#34;sin&#34;,cos]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># If the matrix is of dimension 1xN, the outer brackets have to be</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># added explicitly</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">integer_matrix_1x3</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">[[10, 11, 12]]</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Integer and floats can be specified in standard formats</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">int_value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">42</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">float_value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">123.456e9</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Units can be passed to arithmetic types</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">energy_value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">1.23MeV</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">time_value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">42ns</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Units are combined in linear order without grouping or implicit brackets</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">acceleration_value</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">1.0m/s/s</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Thus the quantity below is the same as 1.0deg*kV*K/m/s</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">random_quantity</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">1.0deg*kV/m/s*K</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Relative paths are expanded to absolute paths, e.g. the following value</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># will become &#34;/home/user/test&#34; if the configuration file is located</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># at &#34;/home/user&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">output_path</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;test&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Booleans can be represented in numerical or textual style</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">my_switch</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">true</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">my_other_switch</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">0</span>
</span></span></code></pre></div>
</div>



    
	
  

    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="User Forum" aria-label="User Forum">
    <a class="text-white" target="_blank" rel="noopener" href="https://allpix-squared-forum.web.cern.ch/" aria-label="User Forum">
      <i class="fas fa-users"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Mailing lists" aria-label="Mailing lists">
    <a class="text-white" target="_blank" rel="noopener" href="https://e-groups.cern.ch/e-groups/EgroupsSearch.do?searchValue=allpix-squared" aria-label="Mailing lists">
      <i class="fas fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitLab" aria-label="GitLab">
    <a class="text-white" target="_blank" rel="noopener" href="https://gitlab.cern.ch/allpix-squared/allpix-squared" aria-label="GitLab">
      <i class="fab fa-gitlab"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/allpix-squared/allpix-squared" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2023 The 100µPET collaboration. Documentation available under the CC-BY-4.0 license.</small>
        
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous"></script>





<script src='/js/tabpane-persist.js'></script>






<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"
    integrity="sha512-vJqxkZ+Sugf/6WRlpcxN01qVfX/29hF6qc33eHF1va3NgoV+U+wCi+uTAsQ10sDoGyBxHLdaHvGwDlV3yVYboA==" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"
    integrity="sha512-5ufNcHqOYgilGEHPfuRIQ5B/vDS1M8+UC+DESZ5CwVgGTg+b2Ol/15rYL/GiCWJ/Sx8oVo0FPFok1dPk8U9INQ=="
    crossorigin="anonymous"></script>



<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mhchem.min.js"
    integrity="sha512-HWb6LyQhO6UkmYLjdSblpgiOvvbdkoMRjln0POPhOVbZu3l4QdqwZnMJ/cuwKScU5pWARejB495TAAAz0WNsXQ=="
    crossorigin="anonymous"></script>


<script defer src='https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js'
    integrity='sha512-ZA/RPrAo88DlwRnnoNVqKINnQNcWERzRK03PDaA4GIJiVZvGFIWQbdWCsUebMZfkWohnfngsDjXzU6PokO4jGw==' crossorigin='anonymous' 
    onload='renderMathInElement(document.body, null);'></script>















<script src="/js/main.min.63f7ccf0f6f052be82a52cc628622eadcdaa7d38aa242c60a3cad13badb12dd9.js" integrity="sha256-Y/fM8PbwUr6CpSzGKGIurc2qfTiqJCxgo8rRO62xLdk=" crossorigin="anonymous"></script>



<script src='/js/prism.js'></script>


<script>
document.body.innerHTML = document.body.innerHTML.replaceAll(/\$<code>(.+?)<\/code>\$/g, '\\($1\\)');
</script>


  </body>
</html>
